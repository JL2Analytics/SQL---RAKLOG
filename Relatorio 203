USE db_visual_rak

SELECT "RODCON"."CODCON" AS CTE, "RODCON"."CTEDTA" AS EMISSAO, "RODCON"."TIPCON" AS TIPO, "RODNFC"."NOTFIS" AS NOTA, "RODNFC"."DATNOT" AS DATA_NOTA, "RODNFC"."PESOKG" AS PESO_KG,  "RODNFC"."QUANTI" AS VOLUME, "RODNFC"."VLRMER" AS VALOR_NOTA, "RODCLI"."RAZSOC" AS PAGADOR, "RODCLI_1"."RAZSOC" AS REMETENTE, "RODMUN"."DESCRI" AS MUN_ORIGEM,  "RODCLI_2"."RAZSOC" AS DESTINATARIO, "RODCLI_2"."CODCGC" AS CNPJ, "RODMUN_1"."DESCRI" AS MUN_DESTINO, "RODMUN_1"."ESTADO" AS UF_DESTINO, "RODCON"."DATLME" AS PRAZO_ENTREGA,  "RODCON"."TOTFRE" AS FRETE,"RODMOT"."NOMMOT" AS MOTORISTA, "RODVEI"."NUMVEI" AS PLACA, "RODVEI_1"."NUMVEI" AS PLACA1, "RODNFC"."DATENT" AS ENTREGA, "VW_ULTIMA_OCORR"."USUATU" AS USUARIO, "VW_ULTIMA_OCORR"."DATATU" AS DATA_BAIXA, "RODOBE"."DESCRI", "RODOCO"."DESCRI" AS OCORRENCIA, "VW_ULTIMA_OCORR"."CODOCO" AS OBSERVACAO, "RODCON"."OBSCON" AS OBS_C, "RODCON"."USUINC" AS USUARIO_EMISSOR,  "RODCON"."CODPAG",   "RODOCO"."CODIGO", "RODCON"."SITUAC", "RODCON"."CODFIL" AS FILIAL, "RODCON"."SERCON"

 FROM   ((((((((((("db_visual_rak"."dbo"."RODCON" "RODCON" LEFT OUTER JOIN "db_visual_rak"."dbo"."RODNFC" "RODNFC" ON (("RODCON"."CODCON"="RODNFC"."CODCON") AND ("RODCON"."SERCON"="RODNFC"."SERCON")) AND ("RODCON"."CODFIL"="RODNFC"."CODFIL")) INNER JOIN "db_visual_rak"."dbo"."RODCLI" "RODCLI" ON "RODCON"."CODPAG"="RODCLI"."CODCLIFOR") INNER JOIN "db_visual_rak"."dbo"."RODCLI" "RODCLI_1" ON "RODCON"."CODREM"="RODCLI_1"."CODCLIFOR") INNER JOIN "db_visual_rak"."dbo"."RODCLI" "RODCLI_2" ON "RODCON"."CODDES"="RODCLI_2"."CODCLIFOR") LEFT OUTER JOIN "db_visual_rak"."dbo"."RODMOT" "RODMOT" ON "RODCON"."CODMOT"="RODMOT"."CODMOT") LEFT OUTER JOIN "db_visual_rak"."dbo"."RODVEI" "RODVEI" ON "RODCON"."PLACA"="RODVEI"."CODVEI") LEFT OUTER JOIN "db_visual_rak"."dbo"."RODVEI" "RODVEI_1" ON "RODCON"."PLACA2"="RODVEI_1"."CODVEI") LEFT OUTER JOIN "db_visual_rak"."dbo"."VW_ULTIMA_OCORR_DATATU" "VW_ULTIMA_OCORR" ON "RODNFC"."ID_NFC"="VW_ULTIMA_OCORR"."ID_NFC") LEFT OUTER JOIN "db_visual_rak"."dbo"."RODOCO" "RODOCO" ON "VW_ULTIMA_OCORR"."CODOCO"="RODOCO"."CODIGO") LEFT OUTER JOIN "db_visual_rak"."dbo"."RODOBE" "RODOBE" ON "VW_ULTIMA_OCORR"."CODOBS"="RODOBE"."CODOBS") LEFT OUTER JOIN "db_visual_rak"."dbo"."RODMUN" "RODMUN" ON "RODCLI_1"."CODMUN"="RODMUN"."CODMUN") LEFT OUTER JOIN "db_visual_rak"."dbo"."RODMUN" "RODMUN_1" ON "RODCLI_2"."CODMUN"="RODMUN_1"."CODMUN"
 WHERE  ("RODCON"."CTEDTA">={ts '2022-01-01 00:00:00'}) AND  NOT ("RODCON"."SITUAC"='C' OR "RODCON"."SITUAC"='I')
 ORDER BY "RODOCO"."CODIGO"
